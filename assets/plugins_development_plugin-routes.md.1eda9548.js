import{_ as a,o as p,c as l,C as s,a as o,t as e,V as t}from"./chunks/framework.30da3c52.js";const m=JSON.parse('{"title":"Routes Plugin","description":"","frontmatter":{"title":"Routes Plugin"},"headers":[],"relativePath":"plugins/development/plugin-routes.md","filePath":"plugins/development/plugin-routes.md","lastUpdated":1679093544000}'),r={name:"plugins/development/plugin-routes.md"},c={id:"frontmatter-title",tabindex:"-1"},C=s("a",{class:"header-anchor",href:"#frontmatter-title","aria-label":'Permalink to "{{ $frontmatter.title }}"'},"​",-1),F=t(`<p>To add your own routes you have to implement the trait <code>dev.mongocamp.server.plugin.RoutesPlugin</code>.</p><p>Routes are implemented with <a href="https://tapir.softwaremill.com/en/latest/endpoint/basics.html" target="_blank" rel="noreferrer">Tapir Endpoints</a> and activated by Reflection.</p><h2 id="sample" tabindex="-1">Sample <a class="header-anchor" href="#sample" aria-label="Permalink to &quot;Sample&quot;">​</a></h2><div class="language-scala"><button title="Copy Code" class="copy"></button><span class="lang">scala</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">mongocamp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">sample</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">plugin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">com</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">typesafe</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">scalalogging</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">LazyLogging</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">mongocamp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">exception</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">ErrorDescription</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">mongocamp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">model</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">auth</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">UserInformation</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">mongocamp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">plugin</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">RoutesPlugin</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sttp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">capabilities</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sttp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">capabilities</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">akka</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">AkkaStreams</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sttp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">model</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">{ </span><span style="color:#FFCB6B;">Method</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">StatusCode</span><span style="color:#A6ACCD;"> }</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sttp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">tapir</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">server</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">ServerEndpoint</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">sttp</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">tapir</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">stringBody</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">scala</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">concurrent</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">Future</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">SampleRoutes</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">RoutesPlugin</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">with</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">LazyLogging</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">override</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">endpoints</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">List</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">ServerEndpoint</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">AkkaStreams</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">with</span><span style="color:#A6ACCD;"> capabilities.</span><span style="color:#FFCB6B;">WebSockets</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">]] </span><span style="color:#89DDFF;">=</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">List</span><span style="color:#A6ACCD;">(adminTestEndpoint, securedTestEndpoint, unsecuredTestEndpoint)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">lazy</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">val</span><span style="color:#A6ACCD;"> adminTestEndpoint </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> adminEndpoint</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .out(stringBody)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .tag(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sample Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .method(</span><span style="color:#FFCB6B;">Method</span><span style="color:#A6ACCD;">.</span><span style="color:#FFCB6B;">GET</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .serverLogic(user </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> parameter </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> adminOutput(user))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">adminOutput</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;font-style:italic;">userProfile</span><span style="color:#A6ACCD;">: </span><span style="color:#FFCB6B;">UserInformation</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">Either</span><span style="color:#A6ACCD;">[(</span><span style="color:#FFCB6B;">StatusCode</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">), </span><span style="color:#FFCB6B;">String</span><span style="color:#A6ACCD;">]] </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">.successful </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#FFCB6B;">Right</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">userProfile.userId</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> you are admin</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">lazy</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">val</span><span style="color:#A6ACCD;"> securedTestEndpoint </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> securedEndpoint</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">secured</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .out(stringBody)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .tag(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sample Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .method(</span><span style="color:#FFCB6B;">Method</span><span style="color:#A6ACCD;">.</span><span style="color:#FFCB6B;">GET</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .serverLogic(user </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> parameter </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> securedOutput(user))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">securedOutput</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;font-style:italic;">userProfile</span><span style="color:#A6ACCD;">: </span><span style="color:#FFCB6B;">UserInformation</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">Either</span><span style="color:#A6ACCD;">[(</span><span style="color:#FFCB6B;">StatusCode</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">), </span><span style="color:#FFCB6B;">String</span><span style="color:#A6ACCD;">]] </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">.successful </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#FFCB6B;">Right</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">s</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">userProfile.userId</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> you are secured</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">val</span><span style="color:#A6ACCD;"> unsecuredTestEndpoint </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> baseEndpoint</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .in(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unsecured</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .out(stringBody)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .method(</span><span style="color:#FFCB6B;">Method</span><span style="color:#A6ACCD;">.</span><span style="color:#FFCB6B;">GET</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .tag(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Sample Plugin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    .serverLogic(_ </span><span style="color:#89DDFF;">=&gt;</span><span style="color:#A6ACCD;"> unsecureRoute())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">def</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">unsecureRoute</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">[</span><span style="color:#FFCB6B;">Either</span><span style="color:#A6ACCD;">[(</span><span style="color:#FFCB6B;">StatusCode</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">ErrorDescription</span><span style="color:#A6ACCD;">), </span><span style="color:#FFCB6B;">String</span><span style="color:#A6ACCD;">]] </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">Future</span><span style="color:#A6ACCD;">.successful(</span><span style="color:#FFCB6B;">Right</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unsecure route</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div>`,4);function y(n,D,A,i,B,u){return p(),l("div",null,[s("h1",c,[o(e(n.$frontmatter.title)+" ",1),C]),F])}const g=a(r,[["render",y]]);export{m as __pageData,g as default};
